SELECT
  Регистратор,
  SUM(CASE WHEN ВидДвижения = 0
           THEN  Сумма
           ELSE -Сумма END) AS Сумма
FROM
  РегистрНакопления.РегистрНакопленияОстатки
GROUP BY
  Регистратор
;