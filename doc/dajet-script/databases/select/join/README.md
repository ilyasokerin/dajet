## DaJet Script

[SELECT](https://github.com/zhichkin/dajet/tree/main/doc/dajet-script/databases/select/README.md)

### Оператор JOIN

Табличный оператор **JOIN** реализован DaJet Script аналогично стандарту ```SQL```. Однако синтаксис DaJet Script более строг и требует явного указания вида соединения перед ключевым словом **JOIN** - значение по умолчанию не предусмотрено. В качестве табличного источника оператор **JOIN** может использовать идентификаторы таблиц базы данных (их имена) или табличные выражения - запрос **SELECT**, заключённый в круглые скобки. Кроме этого могут также использоваться общие табличные выражения, описанные в соответствующем разделе документации.

Поддерживаются следующие виды соединений:
- FULL (полное соединение)
- LEFT (левое соединение)
- RIGHT (правое соединение)
- INNER (внутреннее соединение)

**Простые идентификаторы таблиц**

В данном примере в качестве левого операнда табличного оператора **JOIN** используется таблица ```РегистрНакопления.ЗапасыНаСкладах```, а правого операнда - ```Справочник.Номенклатура```. Выполняется внутреннее соединение на равенство измерения ```Номенклатура``` первого операнда (синоним ```Запасы```) и ключевому реквизиту ```Ссылка``` второго (синоним ```Товары```): ```Запасы.Номенклатура = Товары.Ссылка```.

```SQL
DECLARE @table   array
DECLARE @company entity

USE 'mssql://zhichkin/unf'

   -- Запрос скалярного значения (entity)
   SELECT Ссылка INTO @company
     FROM Справочник.Организации
    WHERE Код = '00-000001'

   -- Запрос набора записей (array)
    SELECT TOP 10
           Товар      = Товары.Наименование
         , Количество = SUM(CASE WHEN Запасы.ВидДвижения = 0
                                THEN  Запасы.Количество -- Приход
                                ELSE -Запасы.Количество -- Расход
                           END)
      INTO @table
      FROM РегистрНакопления.ЗапасыНаСкладах AS Запасы
INNER JOIN Справочник.Номенклатура           AS Товары
        ON Запасы.Организация  = @company
       AND Запасы.Номенклатура = Товары.Ссылка
     GROUP BY Товары.Наименование
    HAVING SUM(CASE WHEN Запасы.ВидДвижения = 0
                   THEN  Запасы.Количество
                   ELSE -Запасы.Количество END) > 0
     ORDER BY Товары.Наименование ASC

END

IF @table = NULL
THEN RETURN 'Нет данных'
ELSE RETURN @table
END
```

**Пример табличных выражений**
```SQL

```

**Пример общего табличного выражения**
```SQL

```

[Наверх](#оператор-join)
