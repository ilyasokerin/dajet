## DaJet Script

[Начало](https://github.com/zhichkin/dajet/tree/main/doc/dajet-script/README.md)

### Параллельное выполнение кода

Параллельное выполнение кода реализуется DaJet Script при помощи команды **FOR** со специальным ключевым словом **MAXDOP**, после которого указывается значение параллелизма: число или ключевое слово **UNBOUNDED** (без ограничений). Таким образом, весь блок команд команды **FOR** рассматривается как обособленный поток выполнения операционной системы.

```SQL
FOR <object> IN <array> MAXDOP { <degree-of-parallelism> | UNBOUNDED }
   <statements>
END
```
**\<array\>** - переменная типа ```array``` - массив элементов типа ```object```.<br>
**\<object\>** - переменная типа ```object``` - элемент массива \<array\>.<br>
**\<statements\>** - блок команд DaJet Script, который выполняется для каждого значения \<object\> в отдельном потоке операционной системы.

**\<degree-of-parallelism\>** - (целое число) максимально допустимое количество потоков операционной системы, одновременно используемых для обработки заданий \<object\>. Фактическое количество потоков может быть меньше, но не должно превышать значение равное \<degree-of-parallelism\>. Количество потоков и своевременная загрузка освободившихся потоков новыми заданиями контроллируется средой выполнения DaJet Script. В случае, если, указанное в опции **MAXDOP** значение \<degree-of-parallelism\> превышает фактическое количество ядер ЦПУ, установленных в системе, среда выполнения DaJet Script автоматически установит его равным фактическому количеству ядер.

**UNBOUNDED** - опция, которая позволяет игнорировать количество ядер ЦПУ, установленных в системе. Будет создано такое количество потоков операционной системы, которое равно количеству \<object\> указанного \<array\>.

Таким образом, прежде, чем начать параллельное выполнение кода, необходимо сформировать нужное количество заданий \<object\>, поместив их в массив \<array\>.

> Важно отметить, что значения всех переменных, на которые ссылаются команды \<statements\> будут переданы в поток выполнения по значению, то есть их текущие значения будут скопированы, а все обращения к ним изолированы в области видимости блока команды **FOR** соответствующего потока. То есть, один поток - одна обособленная область видимости переменных.
> Таким образом изменение соответствующих переменных из родительской области видимости невозможно!

**Параллельное выполнение с ограничением количества потоков**
```SQL

```

**Параллельное выполнение без ограничения количества потоков**
```SQL

```

[Наверх](#параллельное-выполнение-кода)
