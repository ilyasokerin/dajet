## DaJet Script

### Объявление и использование переменных

- [Объявление](#объявление)
- [Инициализация](#инициализация)
- [Присваивание значения](#присваивание-значения)
- [Область видимости](#область-видимости)
- [Присваивание значения запросом](#присваивание-значения-запросом)
- [Тип ```entity```](#тип-entity)
- [Тип ```object```](#тип-object)
- [Тип ```array```](#тип-array)
- [Инициализация запросом СУБД](#инициализация-запросом-субд)
- [Инициализация запросом http](#инициализация-запросом-http)

### Объявление

Объявление переменных DaJet Script выполняется командой **DECLARE**. Объявление переменных может осуществляться в любом месте скрипта, однако при этом следует учитывать их область видимости. Общий синтаксис команды выглядит следующим образом:

```TSQL
DECLARE @<identifier> <type> [= <initializer>]
```
**\<identifier\>** - имя переменной.<br>
**\<type\>** - тип переменной (одно из допустимых ключевых слов).<br>
**\<initializer\>** - необязательный инициализатор: скалярное значение (литерал) или запрос СУБД.

> Переменные типа ```entity``` должны иметь инициализатор! Это исключение.

> Переменным, объявленным без иницализации, присваиваются значения по умолчанию.

> Переменные типов ```object``` и ```array``` инициализируются результатами выполнения других команд.

В следующем примере объявляются переменные всех допустимых типов данных DaJet Script. Их значения выводятся в лог программы. Обратите внимание, что объявление переменной типа ```entity``` закомментировано, так как в противном случае было бы выдано следующее сообщение об ошибке:

> \[DECLARE @entity entity\] must have initializer

```TSQL
--DECLARE @entity entity
DECLARE @boolean  boolean
DECLARE @decimal  number
DECLARE @integer  number
DECLARE @datetime datetime
DECLARE @string   string
DECLARE @binary   binary
DECLARE @uuid     uuid
DECLARE @object   object
DECLARE @array    array

PRINT 'boolean  = ' + @boolean
PRINT 'decimal  = ' + @decimal
PRINT 'integer  = ' + @integer
PRINT 'datetime = ' + @datetime
PRINT 'string   = ' + @string
PRINT 'binary   = ' + @binary
PRINT 'uuid     = ' + @uuid
PRINT 'object   = ' + @object
PRINT 'array    = ' + @array
```
**Результат выполнения скрипта**
```
[2024-09-30 17:52:37] boolean  = false
[2024-09-30 17:52:37] decimal  = 0.00
[2024-09-30 17:52:37] integer  = 0.00
[2024-09-30 17:52:37] datetime = 0001-01-01 00:00:00
[2024-09-30 17:52:37] string   =    -- Это комментарий: пустая строка
[2024-09-30 17:52:37] binary   = 0x -- Тоже комментарий: пустой массив байт
[2024-09-30 17:52:37] uuid     = 00000000-0000-0000-0000-000000000000
[2024-09-30 17:52:37] object   = null
[2024-09-30 17:52:37] array    = null
```

Важно отметить, что универсальный числовой тип данных ```number``` по умолчанию инициализируется десятичным числом ```0.00```. В некоторых случаях это имеет значение. Например, функция баз данных **COUNT** возвращает целое число. Для того, чтобы инициализировать ```number``` целочисленным типом ```integer```, в отличие от десятичного ```decimal```, следует использовать литерал числа без десятичной точки. Например вот так:

```TSQL
DECLARE @integer number = 0    -- Это целое число
DECLARE @decimal number = 0.00 -- Это десятичное число
```
Более наглядный пример сравнения двух чисел:
```TSQL
DECLARE @integer number = 0
DECLARE @decimal number = 0.00

IF @integer = 0
   THEN PRINT '@integer равно 0'
   ELSE PRINT '@integer не равно 0'
END

IF @decimal = 0
   THEN PRINT '@decimal равно 0'
   ELSE PRINT '@decimal не равно 0'
END

IF @integer = @decimal
   THEN PRINT '@integer равно @decimal'
   ELSE PRINT '@integer не равно @decimal'
END
```
**Результат выполнения скрипта**
```
[2024-09-30 20:38:13] @integer равно 0
[2024-09-30 20:38:13] @decimal не равно 0
[2024-09-30 20:38:13] @integer не равно @decimal
```
[Наверх](#объявление-и-использование-переменных)

### Инициализация

Инициализация переменных может выполняться при помощи оператора присваивания ```=``` (знак "равно") непосредственно в команде объявления переменной **DECLARE**. Следующий пример демонстрирует это, используя допустимые DaJet Script соответствующие литералы.

```TSQL
DECLARE @boolean  boolean  = true
DECLARE @decimal  number   = 12.34
DECLARE @integer  number   = 12345
DECLARE @datetime datetime = '2022-08-01T12:34:56'
DECLARE @string   string   = 'Это тестовая строка'
DECLARE @binary   binary   = 0x001234567890ABCDEF
DECLARE @uuid     uuid     = 'ba1f9927-0aec-11ed-9cd3-408d5c93cc8e'
DECLARE @entity   entity   = {12:e3aed142-9dbf-11ed-9ce2-408d5c93cc8e}
DECLARE @object   object   -- Литерал не определён
DECLARE @array    array    -- Литерал не определён

PRINT 'boolean  = ' + @boolean
PRINT 'decimal  = ' + @decimal
PRINT 'integer  = ' + @integer
PRINT 'datetime = ' + @datetime
PRINT 'string   = ' + @string
PRINT 'binary   = ' + @binary
PRINT 'uuid     = ' + @uuid
PRINT 'entity   = ' + @entity
PRINT 'object   = ' + @object
PRINT 'array    = ' + @array
```
**Результат выполнения скрипта**
```
[2024-09-30 17:46:19] boolean  = true
[2024-09-30 17:46:19] decimal  = 12.34
[2024-09-30 17:46:19] integer  = 12345
[2024-09-30 17:46:19] datetime = 2022-08-01 12:34:56
[2024-09-30 17:46:19] string   = Это тестовая строка
[2024-09-30 17:46:19] binary   = 0x001234567890abcdef
[2024-09-30 17:46:19] uuid     = ba1f9927-0aec-11ed-9cd3-408d5c93cc8e
[2024-09-30 17:46:19] entity   = {12:e3aed142-9dbf-11ed-9ce2-408d5c93cc8e}
[2024-09-30 17:46:19] object   = null
[2024-09-30 17:46:19] array    = null
```
[Наверх](#объявление-и-использование-переменных)

### Присваивание значения

Присваивание значений переменным выполняется при помощи команды **SET**. Переменной может быть присвоено скалярное значение, выраженное литералом, значение другой переменной, результат вычисления выражения или выполнения запроса к базе данных. Общий синтаксис команды выглядит следующим образом:
```TSQL
SET @<identifier> = <expression>
```
**\<identifier\>** - имя переменной, как объявлено командой **DECLARE**.<br>
**\<expression\>** - скалярное значение (литерал), выражение или запрос СУБД.
```TSQL
DECLARE @text string
DECLARE @name string = 'Мир'
SET @text = 'Привет' + ', ' + @name + '!'
PRINT @text
```
**Результат выполнения скрипта**
```
[2024-09-30 20:54:39] Привет, Мир!
```
[Наверх](#объявление-и-использование-переменных)

### Область видимости

[Наверх](#объявление-и-использование-переменных)

### Присваивание значения запросом

[Наверх](#объявление-и-использование-переменных)

### Тип ```entity```

[Наверх](#объявление-и-использование-переменных)

### Тип ```object```

[Наверх](#объявление-и-использование-переменных)

### Тип ```array```

[Наверх](#объявление-и-использование-переменных)

### Инициализация запросом СУБД

[Наверх](#объявление-и-использование-переменных)

### Инициализация запросом http

[Наверх](#объявление-и-использование-переменных)
